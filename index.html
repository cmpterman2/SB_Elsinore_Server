<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>StrangeBrew Elsinore by DougEdey</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>StrangeBrew Elsinore</h1>
        <h2>Java Server for Strangebrew Elsinore</h2>
        <a href="https://github.com/DougEdey/SB_Elsinore_Server" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a name="strangebrew-elsinore-server" class="anchor" href="#strangebrew-elsinore-server"><span class="octicon octicon-link"></span></a>Strangebrew Elsinore Server</h1>

<p>Java Server for Strangebrew Elsinore</p>

<p>The purpose of this project is to create a Java application that can run on small systems such as the RaspberryPi and the Beaglebone series</p>

<p>Since these systems run on Linux, that is a requirement to using this.</p>

<p>The system is based off the Dallas One Wire protocol for the temperature probes (expanding to analogue inputs too), and Straightforward GPIO outputs for SSR control</p>

<h1>
<a name="setup-instructions" class="anchor" href="#setup-instructions"><span class="octicon octicon-link"></span></a>Setup Instructions</h1>

<p><a href="extras/BeagleboneBlackSetup.md">Beaglebone Black</a></p>

<p><a href="extras/RaspberryPiSetup.md">RaspberryPi</a></p>

<p><a href="http://dougedey.github.io/2014/03/22/Raspberry-Pi-Basic-Setup/">More indepth RPi Documentation</a></p>

<p><a href="http://www.homebrewtalk.com/f170/raspberry-pi-strangebrew-elsinore-basic-setup-463590/#post5961579">HBT Thread for RaspberryPi setup</a></p>

<h1>
<a name="startup-instructions" class="anchor" href="#startup-instructions"><span class="octicon octicon-link"></span></a>Startup Instructions</h1>

<p>Clone this repository:</p>

<p><code>git clone https://github.com/DougEdey/SB_Elsinore_Server</code></p>

<p>Move to the checked out Directory:</p>

<p><code>cd SB_Elsinore_Server</code></p>

<p>Run:</p>

<p><code>java -jar Elsinore.jar [options ]</code></p>

<p>To startup the setup procedure, I am aware that it needs to be improved, if you have any suggestions, please raise a bug
Use -help to show the full list of options.</p>

<p>Then check the config file if you want to, then you can copy the new one to the default name</p>

<p><code>cp rpibrew.cfg.new rpibrew.cfg</code></p>

<p>And rerun Elsinore to get started</p>

<p><code>java -jar Elsinore.jar [options]</code></p>

<h1>
<a name="raspberrypi-or-beagleboard" class="anchor" href="#raspberrypi-or-beagleboard"><span class="octicon octicon-link"></span></a>RaspberryPi or Beagleboard?</h1>

<p>The BeagleBoard Black does have a big advantage over the RPi, it has onboard analogue inputs, but these are 1.8V.</p>

<p>The RaspberryPi works fine with the existing software, the only thing you need to do differently is naming the GPIO Pinouts.</p>

<h1>
<a name="pump-control" class="anchor" href="#pump-control"><span class="octicon octicon-link"></span></a>Pump Control</h1>

<p>Elsinore now supports pumps, you'll need to add a new section called "pumps" and each pump must be on it's own line in the form 
<code>name=gpio</code></p>

<p>The buttons will be RED when on, and GRAY when off. </p>

<h1>
<a name="one-wire--owfs" class="anchor" href="#one-wire--owfs"><span class="octicon octicon-link"></span></a>One Wire &amp; OWFS</h1>

<p>One Wire is fantastic (in my opinion) each sensor or device has a full 64 bit address, and you don't have to worry about the order and you can chain them!</p>

<p>One Wire devices can be chained, with only one Pullup resistor before the first connection to a device. I currently have 4 Temperature probes on my circuit, and a ADC, connected using XLR jacks.</p>

<p><a href="http://owfs.org/">OWFS</a> is a much better One Wire Implementation, it is highly recommended to install it, and it is REQUIRED if you use One Wire based Analog inputs (like the DS2450</p>

<p>Install it using your standard package manager, then you need to set a mountpoint up (I use /mnt/1wire) and set </p>

<p><code>server: w1</code> in the OWFS configuration File (/etc/owfs.conf by default), you can chose the ports as you want for OWFSHTTP and OWServer, the configuration tool will setup OWFS if it can.</p>

<p>To manually setup OWFS, use the option -owfs when starting up Elsinore</p>

<h1>
<a name="cutoff-temperature" class="anchor" href="#cutoff-temperature"><span class="octicon octicon-link"></span></a>Cutoff Temperature</h1>

<p>After the <a href="http://imgur.com/a/pwQVE">incident</a> I decided to add a cutoff temperature, in my case I have a temperature probe on my SSRs, and when they go over a certain temperature I want to kill the server so it doesn't get badly damaged</p>

<p>Adding 
<code>cutoff = &lt;string&gt;</code>
To any of the devices, will kill Elsinore when the temperature for that device goes above it.</p>

<p>The String is in the form: </p>

<p>So in the config file below, I can use 85C as a cutoff temperature and it'll turn off when it goes above 85C</p>

<h1>
<a name="system-temperature" class="anchor" href="#system-temperature"><span class="octicon octicon-link"></span></a>System Temperature</h1>

<p>System can be enabled during setup by entering "system" (no quotes) at the prompt.</p>

<p>Also, to enable the System Temperature reading, please add</p>

<p><code>&lt;system /&gt;</code></p>

<p>In the  section of the configuration file.</p>

<h1>
<a name="timers" class="anchor" href="#timers"><span class="octicon octicon-link"></span></a>Timers</h1>

<p>During setup you can add custom timers, just use:</p>

<pre><code>timer &lt;name&gt;
</code></pre>

<p>At the command prompt, if you don't enter a name it will prompt you for one.</p>

<h1>
<a name="config-file" class="anchor" href="#config-file"><span class="octicon octicon-link"></span></a>Config File</h1>

<p>This config file will automatically be parsed and converted to an XML file </p>

<pre><code>[general]
scale = F
#cosm = COSM API KEY
#cosm_feed = YOUR COSM FEED

[kettle]
set_point = 168.0
duty_cycle = 100.0
cycle_time = 2.0
k_param = 41.0
i_param = 169.0
d_param = 4.0
probe = 28-0000032c449f
gpio = GPIO2_1


[mlt]
set_point = 0.0
duty_cycle = 0.0
cycle_time = 2.0
k_param = 44.0
i_param = 165.0
d_param = 4.0
probe = 28-0000032c506e
gpio = 

[pumps]
pump_a = GPIO0_8
pump_foo = GPIO0_9
</code></pre>

<p>This is a sample Setup file, you can see I have two devices setup here, the MLT is a "read only" probe that doesn't have a GPIO associated. Whereas the Kettle is setup with default PID values, and has a GPIO pinout of GPIO2_1.</p>

<p>The scale can be changed between C or F to use Celsius or Fahrenheit on the system.</p>

<h1>
<a name="control-interface" class="anchor" href="#control-interface"><span class="octicon octicon-link"></span></a>Control Interface</h1>

<p>Visit </p>

<pre><code>&lt;ip of your system&gt;:8080/controller
</code></pre>

<p>to access the webUI, which works on mobiles too:</p>

<p><img src="http://i.imgur.com/j59BcFZ.png" alt="Browser Layout"></p>

<p><a href="http://imgur.com/a/jEIbc">Album of the UI Progress</a></p>

<p>This is an example of the PID control interface, temperature probes are displayed on the right hand side as LCD displays. On the Raspberry Pi you'll also get the system temperature (this isn't enabled on Beagleboard yet)</p>

<p>There is also a Android Application which is not currently in development, search my repositories to check this, but it's not deprecated yet, I haven't changed the JSON output from the system so it should continue to work.</p>

<p>Thanks For reading this, if you have any queries please contact me or file a bug.</p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/DougEdey/SB_Elsinore_Server/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/DougEdey/SB_Elsinore_Server/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/DougEdey/SB_Elsinore_Server"></a> is maintained by <a href="https://github.com/DougEdey">DougEdey</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>